function [text] = extractImageText(fname)
% [text] = extractImageText(fname) loads the image specified by the path 'fname'
% and returns the next contained in the image as a string.
load('nist36_model.mat')
load('../data/nist36_valid.mat', 'valid_data', 'valid_labels')



[lines, bw] = findLetters(fname);

data = [];

for j = 1:numel(lines)
    for i = 1:size(lines{j},1)
        temp = bw(lines{j}(i,1):lines{j}(i,3),lines{j}(i,2):lines{j}(i,4));
        temp = imresize(temp,[32 32])
        imshow(temp)
        temp = temp(:)';
        data(i,:) = temp;
    end
    [outputs{j}] = Classify(W, b, data)
%     data = [];
end

[~,estimate_labels] = max(outputs{1},[],2);
[~,real_labels] = max(valid_labels,[],2);

C = confusionmat(real_labels,estimate_labels)
figure
image(C)


end
